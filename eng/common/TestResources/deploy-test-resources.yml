parameters:
- name: ServiceDirectory
  type: string
  default: not-set
- name: ArmTemplateParameters
  type: string
  default: '$subscriptionConfiguration.ArmTemplateParameters'
- name: PlatformArmTemplateParameters
  type: object
  default: {}
- name: DeleteAfterHours
  type: number
  default: 24
- name: Location
  type: string
  default: ''
- name: SubscriptionConfiguration
  type: object
  default: $(sub-config-azure-cloud-test-resources)
- name: Platform
  type: string
  default: ''

# SubscriptionConfiguration will be splat into the parameters of the test
# resources script. It should be JSON in the form:
# {
#   "SubscriptionId": "<subscription id>",
#   "TenantId": "<tenant id>",
#   "TestApplicationId": "<test app id>",
#   "TestApplicationSecret": "<test app secret>",
#   "ProvisionerApplicationId": "<provisioner app id>",
#   "ProvisionerApplicationSecret": "<provisioner app secret>",
#   "Environment": "AzureCloud | AzureGov | AzureChina | <other environment>"
#   "EnvironmentVariables": {
#       "SERVICE_MANAGEMENT_URL": "<service management url>",
#       "STORAGE_ENDPOINT_SUFFIX": "<storage endpoint suffix>",
#       "RESOURCE_MANAGER_URL": "<resource manager url>",
#       "SEARCH_ENDPOINT_SUFFIX": "<search endpoint suffix>",
#       "COSMOS_TABLES_ENDPOINT_SUFFIX": "<cosmos tables endpoint suffix>"
#   },
#   "ArmTemplateParameters": {
#       "keyVaultDomainSuffix": "<keyVaultDomainSuffix>",
#       "storageEndpointSuffix": "<storageEndpointSuffix>",
#       "endpointSuffix": "<endpointSuffix>",
#       "azureAuthorityHost": "<azureAuthorityHost>",
#       "keyVaultEndpointSuffix": "<keyVaultEndpointSuffix>"
#   }
# }


steps:
  - template: /eng/common/TestResources/setup-az-modules.yml

  - pwsh: |
      eng/common/TestResources/Import-AzModules.ps1

    displayName: Deploy test resources
